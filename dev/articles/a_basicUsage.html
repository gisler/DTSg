<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A. Basic usage • DTSg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A. Basic usage">
<meta property="og:description" content="DTSg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DTSg</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_basicUsage.html">A. Basic usage</a>
    </li>
    <li>
      <a href="../articles/b_advancedUsage.html">B. Advanced usage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gisler/DTSg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A. Basic usage</h1>
                        <h4 data-toc-skip class="author">Gerold Hepp</h4>
            
            <h4 data-toc-skip class="date">2022-06-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gisler/DTSg/blob/HEAD/vignettes/a_basicUsage.Rmd" class="external-link"><code>vignettes/a_basicUsage.Rmd</code></a></small>
      <div class="hidden name"><code>a_basicUsage.Rmd</code></div>

    </div>

    
    
<p>This vignette introduces the <code>DTSg</code> package, shows how to create objects of its main as well as only class and explains their two interfaces: R6 as code and S3 in comments. Familiarity with the <code>data.table</code> package helps better understanding certain parts of the vignette, but is not essential to follow it.</p>
<hr>
<div class="section level2">
<h2 id="object-creation">Object creation<a class="anchor" aria-label="anchor" href="#object-creation"></a>
</h2>
<p>First, let’s load some data. The package is shipped with a <code>data.table</code> containing a daily time series of river flows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gisler.github.io/DTSg/">DTSg</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">flow</span><span class="op">)</span>
<span class="va">flow</span>
<span class="co">#&gt;             date   flow</span>
<span class="co">#&gt;    1: 2007-01-01  9.540</span>
<span class="co">#&gt;    2: 2007-01-02  9.285</span>
<span class="co">#&gt;    3: 2007-01-03  8.940</span>
<span class="co">#&gt;    4: 2007-01-04  8.745</span>
<span class="co">#&gt;    5: 2007-01-05  8.490</span>
<span class="co">#&gt;   ---                  </span>
<span class="co">#&gt; 2165: 2012-12-27 26.685</span>
<span class="co">#&gt; 2166: 2012-12-28 28.050</span>
<span class="co">#&gt; 2167: 2012-12-29 23.580</span>
<span class="co">#&gt; 2168: 2012-12-30 18.840</span>
<span class="co">#&gt; 2169: 2012-12-31 17.250</span>
<span class="fu"><a href="../reference/summary.DTSg.html">summary</a></span><span class="op">(</span><span class="va">flow</span><span class="op">)</span>
<span class="co">#&gt;       date                            flow        </span>
<span class="co">#&gt;  Min.   :2007-01-01 00:00:00.0   Min.   :  4.995  </span>
<span class="co">#&gt;  1st Qu.:2008-07-19 00:00:00.0   1st Qu.:  8.085  </span>
<span class="co">#&gt;  Median :2010-01-12 00:00:00.0   Median : 11.325  </span>
<span class="co">#&gt;  Mean   :2010-01-08 23:32:46.7   Mean   : 16.197  </span>
<span class="co">#&gt;  3rd Qu.:2011-07-08 00:00:00.0   3rd Qu.: 18.375  </span>
<span class="co">#&gt;  Max.   :2012-12-31 00:00:00.0   Max.   :290.715</span></code></pre></div>
<p>Now that we have a data set, we can create our first object by providing it to the <code>new</code> method of the package’s main R6 class generator <code>DTSg</code>. In addition, we specify an ID in order to give the object a name:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DTSg.html">DTSg</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  values <span class="op">=</span> <span class="va">flow</span>,
  ID <span class="op">=</span> <span class="st">"River Flow"</span>
<span class="op">)</span></code></pre></div>
<p>Creating an object with the package’s alternative interface abusing an S4 constructor looks like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DTSg.html">new</a></span><span class="op">(</span>
  Class <span class="op">=</span> <span class="st">"DTSg"</span>,
  values <span class="op">=</span> <span class="va">flow</span>,
  ID <span class="op">=</span> <span class="st">"River Flow"</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="object-inspection">Object inspection<a class="anchor" aria-label="anchor" href="#object-inspection"></a>
</h2>
<p>Printing the object shows us, among others, the data provided, the specified ID and that the object represents a regular UTC time series with a periodicity of one day and 2192 timestamps. It also shows us that the first column has been renamed to <em>.dateTime.</em> This column serves as the object’s time index and cannot be changed at will:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span> <span class="co"># or 'print(TS)' or just 'TS'</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;        .dateTime   flow</span>
<span class="co">#&gt;           &lt;POSc&gt;  &lt;num&gt;</span>
<span class="co">#&gt;    1: 2007-01-01  9.540</span>
<span class="co">#&gt;    2: 2007-01-02  9.285</span>
<span class="co">#&gt;    3: 2007-01-03  8.940</span>
<span class="co">#&gt;    4: 2007-01-04  8.745</span>
<span class="co">#&gt;    5: 2007-01-05  8.490</span>
<span class="co">#&gt;   ---                  </span>
<span class="co">#&gt; 2188: 2012-12-27 26.685</span>
<span class="co">#&gt; 2189: 2012-12-28 28.050</span>
<span class="co">#&gt; 2190: 2012-12-29 23.580</span>
<span class="co">#&gt; 2191: 2012-12-30 18.840</span>
<span class="co">#&gt; 2192: 2012-12-31 17.250</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             River Flow</span>
<span class="co">#&gt; Aggregated:     FALSE</span>
<span class="co">#&gt; Regular:        TRUE</span>
<span class="co">#&gt; Periodicity:    Time difference of 1 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     2192</span></code></pre></div>
<p>With this done, we can move on and further explore our newly created time series data object with a summary (<code>summary</code>), a report on missing values (<code>nas</code>) and a plot (<code>plot</code>). It suddenly seems to contain several missing values, which apparently were not there upon loading the data set (<code>plot</code> requires the <code>dygraphs</code> and <code>RColorBrewer</code> packages to be installed; HTML vignettes unfortunately cannot display interactive elements, hence I included a static image of the JavaScript chart instead):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span> <span class="co"># or 'summary(TS)'</span>
<span class="co">#&gt;       flow        </span>
<span class="co">#&gt;  Min.   :  4.995  </span>
<span class="co">#&gt;  1st Qu.:  8.085  </span>
<span class="co">#&gt;  Median : 11.325  </span>
<span class="co">#&gt;  Mean   : 16.197  </span>
<span class="co">#&gt;  3rd Qu.: 18.375  </span>
<span class="co">#&gt;  Max.   :290.715  </span>
<span class="co">#&gt;  NA's   :23</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">nas</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"flow"</span><span class="op">)</span> <span class="co"># or 'nas(TS, cols = "flow")'</span>
<span class="co">#&gt;    .col .group      .from        .to .n</span>
<span class="co">#&gt; 1: flow      1 2007-10-12 2007-10-24 13</span>
<span class="co">#&gt; 2: flow      2 2007-10-26 2007-11-03  9</span>
<span class="co">#&gt; 3: flow      3 2007-11-10 2007-11-10  1</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"dygraphs"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span>
    <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">TS</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"flow"</span><span class="op">)</span> <span class="co"># or 'plot(TS, cols = "flow")'</span>
<span class="op">}</span></code></pre></div>
<p><img src="plot.png"></p>
<p>Looking at the original data set reveals that the missing values implicitly already were there. Putting the data set into the object simply expanded it to the automatically detected periodicity and made them explicit (this behaviour can be changed, however, <code>DTSg</code> objects work best with explicitly missing values):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flow</span><span class="op">[</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2007-10-09"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2007-11-13"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="op">]</span>
<span class="co">#&gt;           date   flow</span>
<span class="co">#&gt;  1: 2007-10-09  9.180</span>
<span class="co">#&gt;  2: 2007-10-10  9.075</span>
<span class="co">#&gt;  3: 2007-10-11  9.000</span>
<span class="co">#&gt;  4: 2007-10-25 18.150</span>
<span class="co">#&gt;  5: 2007-11-04 25.350</span>
<span class="co">#&gt;  6: 2007-11-05 23.550</span>
<span class="co">#&gt;  7: 2007-11-06 23.400</span>
<span class="co">#&gt;  8: 2007-11-07 26.400</span>
<span class="co">#&gt;  9: 2007-11-08 39.150</span>
<span class="co">#&gt; 10: 2007-11-09 37.200</span>
<span class="co">#&gt; 11: 2007-11-11 27.450</span>
<span class="co">#&gt; 12: 2007-11-12 39.750</span>
<span class="co">#&gt; 13: 2007-11-13 31.350</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="object-manipulation">Object manipulation<a class="anchor" aria-label="anchor" href="#object-manipulation"></a>
</h2>
<p>For fairly small gaps like this it might be okay to fill them by means of linear interpolation. Using the <code>colapply</code> method together with the <code>interpolateLinear</code> function will do the trick:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span>  <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">interpolateLinear</span><span class="op">)</span>
<span class="co"># or 'colapply(TS, fun = interpolateLinear)'</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">nas</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Empty data.table (0 rows and 5 cols): .col,.group,.from,.to,.n</span></code></pre></div>
<p>In case no column name is provided through the <code>cols</code> argument of the <code>colapply</code> method, the first numeric column is taken by default. Column names for the <code>cols</code> argument can be requested from <code>DTSg</code> objects with the help of the <code>cols</code> method. It, among others, supports a <code>class</code> and/or <code>pattern</code> argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span><span class="op">)</span> <span class="co"># or 'cols(TS)'</span>
<span class="co">#&gt; [1] "flow"</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span>class <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span> <span class="co"># or 'cols(TS, class = "numeric")'</span>
<span class="co">#&gt; [1] "flow"</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span>class <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span>
<span class="co">#&gt; character(0)</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"double"</span>, <span class="st">"integer"</span><span class="op">)</span><span class="op">)</span> <span class="co"># class of column flow is numeric</span>
<span class="co">#&gt; character(0)</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"f.*w"</span><span class="op">)</span> <span class="co"># or 'cols(TS, pattern = "f.*w")'</span>
<span class="co">#&gt; [1] "flow"</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"temp"</span><span class="op">)</span>
<span class="co">#&gt; character(0)</span></code></pre></div>
<p>The time series reaches from the start of the year 2007 to the end of the year 2012. Let’s say we are only interested in the first two years. With <code>alter</code> we can shorten, lengthen and/or change the periodicity of a <code>DTSg</code> object. The latter can be achieved through its <code>by</code> argument (no example given):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span>  <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">alter</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"2007-01-01"</span>, to <span class="op">=</span> <span class="st">"2008-12-31"</span><span class="op">)</span>
<span class="co"># or 'alter(TS, from = "2007-01-01", to = "2008-12-31")'</span>
<span class="va">TS</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;       .dateTime   flow</span>
<span class="co">#&gt;          &lt;POSc&gt;  &lt;num&gt;</span>
<span class="co">#&gt;   1: 2007-01-01  9.540</span>
<span class="co">#&gt;   2: 2007-01-02  9.285</span>
<span class="co">#&gt;   3: 2007-01-03  8.940</span>
<span class="co">#&gt;   4: 2007-01-04  8.745</span>
<span class="co">#&gt;   5: 2007-01-05  8.490</span>
<span class="co">#&gt;  ---                  </span>
<span class="co">#&gt; 727: 2008-12-27 18.180</span>
<span class="co">#&gt; 728: 2008-12-28 16.575</span>
<span class="co">#&gt; 729: 2008-12-29 13.695</span>
<span class="co">#&gt; 730: 2008-12-30 12.540</span>
<span class="co">#&gt; 731: 2008-12-31 11.940</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             River Flow</span>
<span class="co">#&gt; Aggregated:     FALSE</span>
<span class="co">#&gt; Regular:        TRUE</span>
<span class="co">#&gt; Periodicity:    Time difference of 1 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     731</span></code></pre></div>
<p>In order to get mean monthly river flows as an example, we can use the <code>aggregate</code> method with one of the package’s temporal aggregation level functions (TALFs) as its <code>funby</code> argument (the <code>fun</code> argument also accepts a named character vector or <code>list</code> of functions, which allows for calculating several summary statistics at once):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TSm</span> <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">aggregate</span><span class="op">(</span>funby <span class="op">=</span> <span class="va">byYm____</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>
<span class="co"># or 'aggregate(TS, funby = byYm____, fun = mean)'</span>
<span class="va">TSm</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;      .dateTime      flow</span>
<span class="co">#&gt;         &lt;POSc&gt;     &lt;num&gt;</span>
<span class="co">#&gt;  1: 2007-01-01 25.281290</span>
<span class="co">#&gt;  2: 2007-02-01 14.496964</span>
<span class="co">#&gt;  3: 2007-03-01 12.889839</span>
<span class="co">#&gt;  4: 2007-04-01 12.470500</span>
<span class="co">#&gt;  5: 2007-05-01  9.233226</span>
<span class="co">#&gt; ---                     </span>
<span class="co">#&gt; 20: 2008-08-01 12.641129</span>
<span class="co">#&gt; 21: 2008-09-01 13.710500</span>
<span class="co">#&gt; 22: 2008-10-01 10.626774</span>
<span class="co">#&gt; 23: 2008-11-01  8.902000</span>
<span class="co">#&gt; 24: 2008-12-01 16.435645</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             River Flow</span>
<span class="co">#&gt; Aggregated:     TRUE</span>
<span class="co">#&gt; Regular:        FALSE</span>
<span class="co">#&gt; Periodicity:    1 months</span>
<span class="co">#&gt; Min lag:        Time difference of 28 days</span>
<span class="co">#&gt; Max lag:        Time difference of 31 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     24</span></code></pre></div>
<p>Printing the aggregated object shows us that its <code>aggregated</code> field has been set to <code>TRUE</code>. This is merely an indicator telling us to now interpret the timestamps of the series as periods between subsequent timestamps and not as snap-shots anymore.</p>
<p>The one family of temporal aggregation level functions of the package sets timestamps to the lowest possible point in time of the corresponding temporal aggregation level, i.e. truncates timestamps, and the other family extracts a certain part of them. An example is given for quarters below. By convention, the year is set to 2199 in the latter case:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TSQ</span> <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">aggregate</span><span class="op">(</span>funby <span class="op">=</span> <span class="va">by_Q____</span>, fun <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>
<span class="co"># or 'aggregate(TS, funby = by_Q____, fun = mean)'</span>
<span class="va">TSQ</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;     .dateTime     flow</span>
<span class="co">#&gt;        &lt;POSc&gt;    &lt;num&gt;</span>
<span class="co">#&gt; 1: 2199-01-01 18.46127</span>
<span class="co">#&gt; 2: 2199-04-01 12.95266</span>
<span class="co">#&gt; 3: 2199-07-01 13.48924</span>
<span class="co">#&gt; 4: 2199-10-01 15.84620</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             River Flow</span>
<span class="co">#&gt; Aggregated:     TRUE</span>
<span class="co">#&gt; Regular:        FALSE</span>
<span class="co">#&gt; Periodicity:    3 months</span>
<span class="co">#&gt; Min lag:        Time difference of 90 days</span>
<span class="co">#&gt; Max lag:        Time difference of 92 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     4</span></code></pre></div>
<p>Additional temporal aggregation level functions exist for years, days, hours, minutes and seconds. Furthermore, the temporal aggregation level of certain temporal aggregation level functions can be adjusted via the <code>multiplier</code> argument of the <code>aggregate</code> as well as other methods, e.g. <code>multiplier = 6</code> makes <code>byYm____</code> aggregate to half years instead of months.</p>
<p>The last thing we want to achieve for now is the calculation of moving averages for a window of two time steps before and after each timestamp. We can do so with the help of the <code>rollapply</code> method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TSs</span> <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">rollapply</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, before <span class="op">=</span> <span class="fl">2</span>, after <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co"># or 'rollapply(TS, fun = mean, na.rm = TRUE, before = 2, after = 2)'</span>
<span class="va">TSs</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;       .dateTime    flow</span>
<span class="co">#&gt;          &lt;POSc&gt;   &lt;num&gt;</span>
<span class="co">#&gt;   1: 2007-01-01  9.2550</span>
<span class="co">#&gt;   2: 2007-01-02  9.1275</span>
<span class="co">#&gt;   3: 2007-01-03  9.0000</span>
<span class="co">#&gt;   4: 2007-01-04  8.7720</span>
<span class="co">#&gt;   5: 2007-01-05  8.5710</span>
<span class="co">#&gt;  ---                   </span>
<span class="co">#&gt; 727: 2008-12-27 19.3080</span>
<span class="co">#&gt; 728: 2008-12-28 16.4520</span>
<span class="co">#&gt; 729: 2008-12-29 14.5860</span>
<span class="co">#&gt; 730: 2008-12-30 13.6875</span>
<span class="co">#&gt; 731: 2008-12-31 12.7250</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             River Flow</span>
<span class="co">#&gt; Aggregated:     FALSE</span>
<span class="co">#&gt; Regular:        TRUE</span>
<span class="co">#&gt; Periodicity:    Time difference of 1 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     731</span></code></pre></div>
<p>On a side note, some of the methods, which take a function as an argument (<code>colapply</code> and <code>rollapply</code>) hand over to it an additional <code>list</code> argument called <code>.helpers</code> containing useful data for the development of user defined functions (please see the respective help pages for further information). This can of course be a problem for functions like <code>cumsum</code>, which do not expect such a thing. A solution to this is to set the <code>helpers</code> argument of the respective method to <code>FALSE</code>.</p>
<p>With this said, let’s join the result of the last calculation to the original time series data object and extract its values as a <code>data.table</code> for further processing in a final step (please note that the <em>.dateTime</em> column gets its original name back):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span>  <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">merge</span><span class="op">(</span>y <span class="op">=</span> <span class="va">TSs</span>, suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_orig"</span>, <span class="st">"_movavg"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># or 'merge(TS, y = TSs, suffixes = c("_orig", "_movavg"))'</span>
<span class="va">TS</span><span class="op">$</span><span class="fu">values</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;            date flow_orig flow_movavg</span>
<span class="co">#&gt;   1: 2007-01-01     9.540      9.2550</span>
<span class="co">#&gt;   2: 2007-01-02     9.285      9.1275</span>
<span class="co">#&gt;   3: 2007-01-03     8.940      9.0000</span>
<span class="co">#&gt;   4: 2007-01-04     8.745      8.7720</span>
<span class="co">#&gt;   5: 2007-01-05     8.490      8.5710</span>
<span class="co">#&gt;  ---                                 </span>
<span class="co">#&gt; 727: 2008-12-27    18.180     19.3080</span>
<span class="co">#&gt; 728: 2008-12-28    16.575     16.4520</span>
<span class="co">#&gt; 729: 2008-12-29    13.695     14.5860</span>
<span class="co">#&gt; 730: 2008-12-30    12.540     13.6875</span>
<span class="co">#&gt; 731: 2008-12-31    11.940     12.7250</span></code></pre></div>
<p>Better ways to add results of the <code>colapply</code> or <code>rollapply</code> method as new column(s) are actually their <code>resultCols</code> and <code>suffix</code> arguments. Their use would not have allowed for demonstrating the <code>merge</code> method though.</p>
<hr>
<p>For a full explanation of all the methods and functions available in the package as well as their arguments please consult the help pages. Especially the following methods and functions have not been discussed in this vignette:</p>
<ul>
<li>
<code>getCol</code> or <code>[</code>
</li>
<li><code>refresh</code></li>
<li><code>rowaggregate</code></li>
<li><code>rowbind</code></li>
<li><code>setColNames</code></li>
<li><code>setCols</code></li>
<li><code>subset</code></li>
<li><code>rollback</code></li>
<li><code>S3WrapperGenerator</code></li>
</ul>
</div>
<div class="section level2">
<h2 id="object-fields">Object fields<a class="anchor" aria-label="anchor" href="#object-fields"></a>
</h2>
<p>The fields of a <code>DTSg</code> object of which the metadata are part of can be accessed through so called active bindings:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TS</span><span class="op">$</span><span class="va">ID</span>
<span class="co">#&gt; [1] "River Flow"</span></code></pre></div>
<p>Valid results are returned for the following fields:</p>
<ul>
<li><code>aggregated</code></li>
<li><code>fast</code></li>
<li><code>funbyApproach</code></li>
<li><code>ID</code></li>
<li><code>na.status</code></li>
<li><code>parameter</code></li>
<li><code>periodicity</code></li>
<li><code>regular</code></li>
<li><code>timestamps</code></li>
<li><code>timezone</code></li>
<li><code>unit</code></li>
<li><code>variant</code></li>
</ul>
<p>A subset of this fields can also be actively set (please note that reference semantics always apply to fields, hence the “largely” in the title of the package):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># two new `DTSg` objects in order to demonstrate reference semantics, which are</span>
<span class="co"># propagated by assignments and broken by deep clones</span>
<span class="va">TSassigned</span> <span class="op">&lt;-</span> <span class="va">TS</span>
<span class="va">TScloned</span>   <span class="op">&lt;-</span> <span class="va">TS</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># or 'clone(x = TS, deep = TRUE)'</span>

<span class="co"># set new ID</span>
<span class="va">TS</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="st">"Two River Flows"</span>
<span class="va">TS</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;       .dateTime flow_orig flow_movavg</span>
<span class="co">#&gt;          &lt;POSc&gt;     &lt;num&gt;       &lt;num&gt;</span>
<span class="co">#&gt;   1: 2007-01-01     9.540      9.2550</span>
<span class="co">#&gt;   2: 2007-01-02     9.285      9.1275</span>
<span class="co">#&gt;   3: 2007-01-03     8.940      9.0000</span>
<span class="co">#&gt;   4: 2007-01-04     8.745      8.7720</span>
<span class="co">#&gt;   5: 2007-01-05     8.490      8.5710</span>
<span class="co">#&gt;  ---                                 </span>
<span class="co">#&gt; 727: 2008-12-27    18.180     19.3080</span>
<span class="co">#&gt; 728: 2008-12-28    16.575     16.4520</span>
<span class="co">#&gt; 729: 2008-12-29    13.695     14.5860</span>
<span class="co">#&gt; 730: 2008-12-30    12.540     13.6875</span>
<span class="co">#&gt; 731: 2008-12-31    11.940     12.7250</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             Two River Flows</span>
<span class="co">#&gt; Aggregated:     FALSE</span>
<span class="co">#&gt; Regular:        TRUE</span>
<span class="co">#&gt; Periodicity:    Time difference of 1 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     731</span>

<span class="co"># due to reference semantics, the new ID is also propagated to `TSassigned`, but</span>
<span class="co"># not to `TScloned` (as all data manipulating methods create a deep clone by</span>
<span class="co"># default, it is usually best to set or update fields after and not before</span>
<span class="co"># calling such a method)</span>
<span class="va">TSassigned</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;       .dateTime flow_orig flow_movavg</span>
<span class="co">#&gt;          &lt;POSc&gt;     &lt;num&gt;       &lt;num&gt;</span>
<span class="co">#&gt;   1: 2007-01-01     9.540      9.2550</span>
<span class="co">#&gt;   2: 2007-01-02     9.285      9.1275</span>
<span class="co">#&gt;   3: 2007-01-03     8.940      9.0000</span>
<span class="co">#&gt;   4: 2007-01-04     8.745      8.7720</span>
<span class="co">#&gt;   5: 2007-01-05     8.490      8.5710</span>
<span class="co">#&gt;  ---                                 </span>
<span class="co">#&gt; 727: 2008-12-27    18.180     19.3080</span>
<span class="co">#&gt; 728: 2008-12-28    16.575     16.4520</span>
<span class="co">#&gt; 729: 2008-12-29    13.695     14.5860</span>
<span class="co">#&gt; 730: 2008-12-30    12.540     13.6875</span>
<span class="co">#&gt; 731: 2008-12-31    11.940     12.7250</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             Two River Flows</span>
<span class="co">#&gt; Aggregated:     FALSE</span>
<span class="co">#&gt; Regular:        TRUE</span>
<span class="co">#&gt; Periodicity:    Time difference of 1 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     731</span>
<span class="va">TScloned</span>
<span class="co">#&gt; Values:</span>
<span class="co">#&gt;       .dateTime flow_orig flow_movavg</span>
<span class="co">#&gt;          &lt;POSc&gt;     &lt;num&gt;       &lt;num&gt;</span>
<span class="co">#&gt;   1: 2007-01-01     9.540      9.2550</span>
<span class="co">#&gt;   2: 2007-01-02     9.285      9.1275</span>
<span class="co">#&gt;   3: 2007-01-03     8.940      9.0000</span>
<span class="co">#&gt;   4: 2007-01-04     8.745      8.7720</span>
<span class="co">#&gt;   5: 2007-01-05     8.490      8.5710</span>
<span class="co">#&gt;  ---                                 </span>
<span class="co">#&gt; 727: 2008-12-27    18.180     19.3080</span>
<span class="co">#&gt; 728: 2008-12-28    16.575     16.4520</span>
<span class="co">#&gt; 729: 2008-12-29    13.695     14.5860</span>
<span class="co">#&gt; 730: 2008-12-30    12.540     13.6875</span>
<span class="co">#&gt; 731: 2008-12-31    11.940     12.7250</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ID:             River Flow</span>
<span class="co">#&gt; Aggregated:     FALSE</span>
<span class="co">#&gt; Regular:        TRUE</span>
<span class="co">#&gt; Periodicity:    Time difference of 1 days</span>
<span class="co">#&gt; Missing values: explicit</span>
<span class="co">#&gt; Time zone:      UTC</span>
<span class="co">#&gt; Timestamps:     731</span></code></pre></div>
<p>The fields, which cannot be actively set are:</p>
<ul>
<li><code>regular</code></li>
<li><code>timestamps</code></li>
</ul>
<p>Please refer to the help pages for further details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gerold Hepp.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
