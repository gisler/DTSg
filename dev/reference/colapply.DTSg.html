<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply function column-wise — colapply.DTSg • DTSg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Gelasio-0.4.10/font.css" rel="stylesheet"><link href="../deps/Raleway-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply function column-wise — colapply.DTSg"><meta name="description" content="Applies an arbitrary function to selected columns of a DTSg object."><meta property="og:description" content="Applies an arbitrary function to selected columns of a DTSg object."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DTSg</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/a_basicUsage.html">A. Basic usage</a></li>
    <li><a class="dropdown-item" href="../articles/b_advancedUsage.html">B. Advanced usage</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gisler/DTSg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply function column-wise</h1>
      <small class="dont-index">Source: <a href="https://github.com/gisler/DTSg/blob/main/R/Swrappers.R" class="external-link"><code>R/Swrappers.R</code></a></small>
      <div class="d-none name"><code>colapply.DTSg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applies an arbitrary function to selected columns of a <code><a href="DTSg.html">DTSg</a></code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'DTSg'</span></span>
<span><span class="fu">colapply</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">fun</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  cols <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">cols</span><span class="op">(</span>class <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span>,</span>
<span>  resultCols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  suffix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  helpers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  funby <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ignoreDST <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  multiplier <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  funbyHelpers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  funbyApproach <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">funbyApproach</span>,</span>
<span>  clone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"DTSgClone"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code><a href="DTSg.html">DTSg</a></code> object (S3 method only).</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/function.html" class="external-link">function</a></code>. Its return value must be of length one.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed on to <code>fun</code>.</p></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>A character vector specifying the columns to apply <code>fun</code> to.
Another possibility is a character string containing either comma separated
column names, for example, <code>"x,y,z"</code>, or the start and end column separated
by a colon, for example, <code>"x:z"</code>.</p></dd>


<dt id="arg-resultcols">resultCols<a class="anchor" aria-label="anchor" href="#arg-resultcols"></a></dt>
<dd><p>An optional character vector of the same length as <code>cols</code>
specifying the column names for the return values of <code>fun</code>. Another
possibility is a character string containing comma separated column names,
for example, <code>"x,y,z"</code>. Non-existing columns are added and existing columns
are overwritten. Columns are matched element-wise between <code>cols</code> and
<code>resultCols</code>.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>An optional character string. The return values of <code>fun</code> are
added as new columns with names consisting of the columns specified in
<code>cols</code> and this suffix. Existing columns are never overwritten. Only used
when <code>resultCols</code> is not specified.</p></dd>


<dt id="arg-helpers">helpers<a class="anchor" aria-label="anchor" href="#arg-helpers"></a></dt>
<dd><p>A logical specifying if helper data shall be handed over to
<code>fun</code>. See corresponding section for further information.</p></dd>


<dt id="arg-funby">funby<a class="anchor" aria-label="anchor" href="#arg-funby"></a></dt>
<dd><p>One of the temporal aggregation level functions described in
<code><a href="TALFs.html">TALFs</a></code> or a user defined temporal aggregation level function. Can be
used to apply functions like <code><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></code> to a certain temporal level. See
corresponding section and examples for further information.</p></dd>


<dt id="arg-ignoredst">ignoreDST<a class="anchor" aria-label="anchor" href="#arg-ignoredst"></a></dt>
<dd><p>A logical specifying if day saving time shall be ignored
by <code>funby</code>. See corresponding section for further information.</p></dd>


<dt id="arg-multiplier">multiplier<a class="anchor" aria-label="anchor" href="#arg-multiplier"></a></dt>
<dd><p>A positive integerish value “multiplying” the
temporal aggregation level of certain <code><a href="TALFs.html">TALFs</a></code>. See corresponding section
for further information.</p></dd>


<dt id="arg-funbyhelpers">funbyHelpers<a class="anchor" aria-label="anchor" href="#arg-funbyhelpers"></a></dt>
<dd><p>An optional <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with helper data passed on to
<code>funby</code>. See corresponding section for further information.</p></dd>


<dt id="arg-funbyapproach">funbyApproach<a class="anchor" aria-label="anchor" href="#arg-funbyapproach"></a></dt>
<dd><p>A character string specifying the flavour of the applied
temporal aggregation level function. Either <code>"timechange"</code>, which utilises
<code><a href="https://rdrr.io/pkg/timechange/man/time_round.html" class="external-link">timechange::time_floor</a></code>, or <code>"base"</code>, which utilises <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>, or
<code>"fasttime"</code>, which utilises <code><a href="https://rdrr.io/pkg/fasttime/man/fastPOSIXct.html" class="external-link">fasttime::fastPOSIXct</a></code>, or <code>"RcppCCTZ"</code>,
which utilises <code><a href="https://rdrr.io/pkg/RcppCCTZ/man/parseDatetime.html" class="external-link">RcppCCTZ::parseDatetime</a></code> as the main function for
transforming timestamps.</p></dd>


<dt id="arg-clone">clone<a class="anchor" aria-label="anchor" href="#arg-clone"></a></dt>
<dd><p>A logical specifying if the object shall be modified in place or
if a deep clone (copy) shall be made beforehand.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code><a href="DTSg.html">DTSg</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="helper-data">Helper data<a class="anchor" aria-label="anchor" href="#helper-data"></a></h2>


<p>In addition to the <code>...</code> argument, this method optionally hands over a
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> argument with helper data called <code>.helpers</code> to <code>fun</code>. This <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code>
contains the following elements:</p><ul><li><p><em>.dateTime:</em> A <code><a href="https://rdrr.io/r/base/DateTimeClasses.html" class="external-link">POSIXct</a></code> vector containing the <em>.dateTime</em> column.</p></li>
<li><p><em>periodicity:</em> Same as the <code><a href="DTSg.html">periodicity</a></code> field.</p></li>
<li><p><em>minLag:</em> A <code><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></code> object containing the minimum time difference
between two subsequent timestamps.</p></li>
<li><p><em>maxLag:</em> A <code><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></code> object containing the maximum time difference
between two subsequent timestamps.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="user-defined-talfs-talfs-helper-data-and-multiplier">User defined TALFs, TALFs helper data and multiplier<a class="anchor" aria-label="anchor" href="#user-defined-talfs-talfs-helper-data-and-multiplier"></a></h2>


<p>User defined temporal aggregation level functions have to return a
<code><a href="https://rdrr.io/r/base/DateTimeClasses.html" class="external-link">POSIXct</a></code> vector of the same length as the time series and accept two
arguments: a <code><a href="https://rdrr.io/r/base/DateTimeClasses.html" class="external-link">POSIXct</a></code> vector as its first and a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with helper data
as its second. The default elements of this <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> are as follows:</p><ul><li><p><em>timezone:</em> Same as the <code><a href="DTSg.html">timezone</a></code> field.</p></li>
<li><p><em>ignoreDST:</em> Same as the <code>ignoreDST</code> argument.</p></li>
<li><p><em>periodicity:</em> Same as the <code><a href="DTSg.html">periodicity</a></code> field.</p></li>
<li><p><em>na.status:</em> Same as the <code><a href="DTSg.html">na.status</a></code> field.</p></li>
<li><p><em>multiplier:</em> Same as the <code>multiplier</code> argument.</p></li>
<li><p><em>funbyApproach:</em> Same as the <code>funbyApproach</code> argument.</p></li>
<li><p><em>assertion:</em> A logical specifying if the TALF is called by an assertion.</p></li>
</ul><p>Any additional element specified in the <code>funbyHelpers</code> argument is appended
to the end of the default <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code>. In case <code>funbyHelpers</code> contains an
<em>ignoreDST, multiplier</em> or <em>funbyApproach</em> element, it takes precedence over
the respective method argument. <em>timezone, periodicity</em> and <em>na.status</em>
elements are rejected, as they are always taken directly from the object.</p>
<p>The temporal aggregation level of certain <code><a href="TALFs.html">TALFs</a></code> can be adjusted with the
help of the <code>multiplier</code> argument. A <code>multiplier</code> of <code>10</code>, for example, makes
<code><a href="TALFs.html">byY_____</a></code> aggregate to decades instead of years. Another example
is a <code>multiplier</code> of <code>6</code> provided to <code><a href="TALFs.html">by_m____</a></code>. The function
then aggregates all months of all first and all months of all second half
years instead of all months of all years separately. This feature is
supported by the following <code><a href="TALFs.html">TALFs</a></code> of the package:</p><ul><li><p><code><a href="TALFs.html">byY_____</a></code></p></li>
<li><p><code><a href="TALFs.html">byYm____</a></code></p></li>
<li><p><code><a href="TALFs.html">byYmdH__</a></code> (UTC and equivalent as well as all Etc/GMT time zones only)</p></li>
<li><p><code><a href="TALFs.html">byYmdHM_</a></code></p></li>
<li><p><code><a href="TALFs.html">byYmdHMS</a></code></p></li>
<li><p><code><a href="TALFs.html">by_m____</a></code></p></li>
<li><p><code><a href="TALFs.html">by___H__</a></code> (UTC and equivalent as well as all Etc/GMT time zones only)</p></li>
<li><p><code><a href="TALFs.html">by____M_</a></code></p></li>
<li><p><code><a href="TALFs.html">by_____S</a></code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="ignore-day-saving-time">Ignore day saving time<a class="anchor" aria-label="anchor" href="#ignore-day-saving-time"></a></h2>


<p><code>ignoreDST</code> tells a temporal aggregation level function if it is supposed to
ignore day saving time while transforming the timestamps. This can be a
desired feature for time series strictly following the position of the sun
such as hydrological time series. Doing so ensures that diurnal variations
are preserved by all means and all intervals are of the “correct”
length, however, a possible limitation might be that when the day saving time
shift cannot be estimated, it is assumed to be one hour long and a warning is
issued. This feature requires that the periodicity of the time series has
been recognised and is supported by the following <code><a href="TALFs.html">TALFs</a></code> of the package:</p><ul><li><p><code><a href="TALFs.html">byY_____</a></code></p></li>
<li><p><code><a href="TALFs.html">byYQ____</a></code></p></li>
<li><p><code><a href="TALFs.html">byYm____</a></code></p></li>
<li><p><code><a href="TALFs.html">byYmd___</a></code></p></li>
<li><p><code><a href="TALFs.html">by_Q____</a></code></p></li>
<li><p><code><a href="TALFs.html">by_m____</a></code></p></li>
<li><p><code><a href="TALFs.html">by___H__</a></code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cols.DTSg.html">cols</a></code>, <code><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># new DTSg object</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va"><a href="DTSg.html">DTSg</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>values <span class="op">=</span> <span class="va">flow</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># linear interpolation of missing values</span></span></span>
<span class="r-in"><span><span class="co">## R6 method</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">interpolateLinear</span><span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime   flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  8.940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 26.685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 28.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 23.580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 18.840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 17.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## S3 method</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, fun <span class="op">=</span> <span class="va">interpolateLinear</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime   flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  8.940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 26.685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 28.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 23.580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 18.840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 17.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># daily cumulative sums per month</span></span></span>
<span class="r-in"><span><span class="co">## R6 method</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="va">cumsum</span>,</span></span>
<span class="r-in"><span>  helpers <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  funby <span class="op">=</span> <span class="va">byYm____</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01   9.540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  18.825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  27.765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  36.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  45.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 376.185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 404.235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 427.815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 446.655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 463.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## S3 method</span></span></span>
<span class="r-in"><span><span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="va">cumsum</span>,</span></span>
<span class="r-in"><span>  helpers <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  funby <span class="op">=</span> <span class="va">byYm____</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01   9.540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  18.825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  27.765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  36.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  45.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 376.185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 404.235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 427.815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 446.655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 463.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate moving averages with the help of 'runner' (all four given</span></span></span>
<span class="r-in"><span><span class="co"># approaches provide the same result with explicitly missing timestamps)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"runner"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"runner"</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">package_version</a></span><span class="op">(</span><span class="st">"0.3.5"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">wrapper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">.helpers</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">runner</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span><span class="op">(</span><span class="va">...</span>, idx <span class="op">=</span> <span class="va">.helpers</span><span class="op">[[</span><span class="st">".dateTime"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## R6 method</span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="fu">runner</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="va">wrapper</span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="st">"5 days"</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="st">"-2 days"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="fu">runner</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="st">"5 days"</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="st">"-2 days"</span>,</span></span>
<span class="r-in"><span>    idx <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="fu">getCol</span><span class="op">(</span>col <span class="op">=</span> <span class="st">".dateTime"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="fu">runner</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="st">"5 days"</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="st">"-2 days"</span>,</span></span>
<span class="r-in"><span>    idx <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="st">".dateTime"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## S3 method</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="fu">runner</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="va">wrapper</span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="st">"5 days"</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="st">"-2 days"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="fu">runner</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="st">"5 days"</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="st">"-2 days"</span>,</span></span>
<span class="r-in"><span>    idx <span class="op">=</span> <span class="fu"><a href="getCol.DTSg.html">getCol</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, col <span class="op">=</span> <span class="st">".dateTime"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="fu">runner</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="st">"5 days"</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="st">"-2 days"</span>,</span></span>
<span class="r-in"><span>    idx <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="st">".dateTime"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.2550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  9.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.7720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.5710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 28.9860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 25.3200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 22.8810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 21.9300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 19.8900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.2550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  9.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.7720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.5710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 28.9860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 25.3200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 22.8810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 21.9300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 19.8900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.2550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  9.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.7720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.5710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 28.9860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 25.3200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 22.8810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 21.9300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 19.8900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.2550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  9.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.7720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.5710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 28.9860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 25.3200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 22.8810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 21.9300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 19.8900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime    flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01  9.2550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02  9.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  9.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  8.7720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05  8.5710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27 28.9860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28 25.3200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29 22.8810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30 21.9300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31 19.8900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(call):</span> object 'wrapper' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate rolling correlations somewhat inefficiently with the help of</span></span></span>
<span class="r-in"><span><span class="co"># 'runner'</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"runner"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"runner"</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">package_version</a></span><span class="op">(</span><span class="st">"0.3.8"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">wrapper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">f</span>, <span class="va">k</span>, <span class="va">lag</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">runner</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/runner/man/runner.html" class="external-link">runner</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      k <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>      lag <span class="op">=</span> <span class="va">lag</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## R6 method</span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">$</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="va">wrapper</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="st">"flow"</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"flow"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">cor</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## S3 method</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="print.DTSg.html">print</a></span><span class="op">(</span><span class="fu">colapply</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="va">wrapper</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="st">"flow"</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"flow"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    f <span class="op">=</span> <span class="va">cor</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    lag <span class="op">=</span> <span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        .dateTime        flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;POSc&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 2007-01-01 -0.65071468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 2007-01-02 -0.43767757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 2007-01-03  0.01808569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 2007-01-04  0.41567684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 2007-01-05 -0.53300739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2188: 2012-12-27  0.98727366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2189: 2012-12-28  0.98700468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2190: 2012-12-29  0.98780552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2191: 2012-12-30  0.98822407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2192: 2012-12-31  0.99540697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregated:     FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regular:        TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Periodicity:    Time difference of 1 days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Missing values: explicit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time zone:      UTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timestamps:     2192</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(call):</span> object 'wrapper' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gerold Hepp.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

